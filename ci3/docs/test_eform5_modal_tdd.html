<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EForm5 Modal TDD Test</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
    
    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- æ¸¬è©¦æ¡†æ¶ -->
    <style>
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #dee2e6;
            border-radius: 5px;
        }
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 3px;
        }
        .test-pass {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .test-fail {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .test-info {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        /* Bootstrap Modal è‡ªå®šç¾©æ¨£å¼ */
        .form-confirmation-content {
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
        }
        
        .info-block {
            border: 1px solid #dee2e6;
        }
        
        .info-block h6 {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        .info-block .row {
            margin-left: 0;
            margin-right: 0;
        }
        
        .info-block .row > div {
            font-size: 14px;
            line-height: 1.5;
        }
    </style>
</head>
<body>
    <div class="container mt-4">
        <h1>EForm5 Bootstrap Modal TDD æ¸¬è©¦</h1>
        <p>é€™å€‹é é¢ç”¨æ–¼æ¸¬è©¦ EForm5 Bootstrap modal åŠŸèƒ½çš„å®Œæ•´æ€§</p>
        
        <!-- æ¸¬è©¦çµæœå€åŸŸ -->
        <div id="test-results"></div>
        
        <!-- æ¨¡æ“¬è¡¨å–® -->
        <div class="test-section">
            <h3>æ¨¡æ“¬ EForm5 è¡¨å–®</h3>
            <form id="mockEform5">
                <!-- åŸºæœ¬è³‡æ–™ -->
                <div class="row">
                    <div class="col-4">
                        <label>å§“å</label>
                        <input type="text" name="name" class="form-control" value="æ¸¬è©¦ç”¨æˆ¶">
                    </div>
                    <div class="col-4">
                        <label>æ‰‹æ©Ÿ</label>
                        <input type="text" name="phone" class="form-control" value="0912345678">
                    </div>
                    <div class="col-4">
                        <label>æ€§åˆ¥</label>
                        <select name="gender" class="form-control">
                            <option value="">è«‹é¸æ“‡</option>
                            <option value="ç”·" selected>ç”·</option>
                            <option value="å¥³">å¥³</option>
                        </select>
                    </div>
                </div>
                
                <div class="row mt-2">
                    <div class="col-4">
                        <label>å¹´é½¡</label>
                        <select name="age" class="form-control">
                            <option value="">è«‹é¸æ“‡</option>
                            <option value="25" selected>æ°‘åœ‹88å¹´å‡ºç”Ÿ - 25æ­²</option>
                        </select>
                    </div>
                    <div class="col-4">
                        <label>èº«é«˜</label>
                        <input type="text" name="height" class="form-control" value="175">
                    </div>
                    <div class="col-4">
                        <label>é‹å‹•ç¿’æ…£</label>
                        <select name="exercise_habit" class="form-control">
                            <option value="æ˜¯" selected>æ˜¯</option>
                        </select>
                    </div>
                </div>
                
                <!-- é«”æ¸¬æ•¸æ“š -->
                <h5 class="mt-3">é«”æ¸¬æ¨™æº–å»ºè­°å€¼</h5>
                <div class="row">
                    <div class="col-4">
                        <label>é«”é‡</label>
                        <input type="text" name="weight" class="form-control" value="70">
                    </div>
                    <div class="col-4">
                        <label>BMI</label>
                        <input type="text" name="bmi" class="form-control" value="22.9">
                    </div>
                    <div class="col-4">
                        <label>é«”è„‚ç‡</label>
                        <input type="text" name="fat_percentage" class="form-control" value="15">
                    </div>
                </div>
                
                <!-- è·æ¥­ï¼ˆcheckboxï¼‰ -->
                <h5 class="mt-3">è·æ¥­</h5>
                <div class="row">
                    <div class="col-4">
                        <label><input type="checkbox" name="occupation[]" value="ä¸Šç­æ—" checked> ä¸Šç­æ—</label>
                    </div>
                    <div class="col-4">
                        <label><input type="checkbox" name="occupation[]" value="å­¸ç”Ÿ"> å­¸ç”Ÿ</label>
                    </div>
                </div>
                
                <!-- å¥åº·å›°æ“¾ -->
                <h5 class="mt-3">å¥åº·å›°æ“¾</h5>
                <div class="row">
                    <div class="col-4">
                        <label><input type="checkbox" name="health_concerns[]" value="å¤±çœ " checked> å¤±çœ </label>
                    </div>
                    <div class="col-4">
                        <label><input type="checkbox" name="health_concerns[]" value="ç–²å‹" checked> ç–²å‹</label>
                    </div>
                </div>
                
                <!-- ç”¨è—¥ç¿’æ…£ -->
                <h5 class="mt-3">ç”¨è—¥ç¿’æ…£</h5>
                <div class="row">
                    <div class="col-6">
                        <label><input type="radio" name="has_medication_habit" value="1" checked> æ˜¯</label>
                        <label><input type="radio" name="has_medication_habit" value="0"> å¦</label>
                    </div>
                </div>
                <input type="text" name="medication_name" class="form-control mt-2" placeholder="è—¥ç‰©åç¨±" value="ç¶­ä»–å‘½D">
                
                <!-- å»ºè­°ç”¢å“ -->
                <h5 class="mt-3">å»ºè­°ç”¢å“</h5>
                <div class="row">
                    <div class="col-4">
                        <label><input type="checkbox" name="recommended_products[]" value="ç²¾åŠ›ç´ " checked> ç²¾åŠ›ç´ </label>
                    </div>
                    <div class="col-4">
                        <label><input type="checkbox" name="recommended_products[]" value="éˆèŠEX"> éˆèŠEX</label>
                    </div>
                </div>
                <input type="text" name="energy_essence_dosage" class="form-control mt-2" placeholder="ç²¾åŠ›ç´ æ”å–é‡" value="æ¯æ—¥2é¡†">
                
                <button type="button" class="btn btn-danger mt-3" onclick="showConfirmModal()">é€å‡ºè¡¨å–®ï¼ˆæ¸¬è©¦ï¼‰</button>
            </form>
        </div>
        
        <!-- Bootstrap Modal -->
        <div class="modal fade" id="confirmModal" tabindex="-1" role="dialog" aria-labelledby="confirmModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="confirmModalLabel">ç¢ºèªè¡¨å–®å…§å®¹</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body" id="confirmModalBody">
                        <!-- è¡¨å–®å…§å®¹å°‡å‹•æ…‹è¼‰å…¥æ­¤è™• -->
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">å–æ¶ˆ</button>
                        <button type="button" class="btn btn-danger" id="confirmSubmitBtn">ç¢ºèªé€å‡º</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- åŸ·è¡Œæ¸¬è©¦æŒ‰éˆ• -->
        <div class="test-section">
            <h3>TDD æ¸¬è©¦åŸ·è¡Œ</h3>
            <button class="btn btn-primary" onclick="runAllTests()">åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦</button>
            <button class="btn btn-success" onclick="runSingleTest()">åŸ·è¡Œå–®ä¸€åŠŸèƒ½æ¸¬è©¦</button>
            <button class="btn btn-info" onclick="clearTestResults()">æ¸…é™¤æ¸¬è©¦çµæœ</button>
        </div>
    </div>
    
    <script>
        // TDD æ¸¬è©¦æ¡†æ¶
        class ModalTDDTest {
            constructor() {
                this.results = [];
            }
            
            // æ¸¬è©¦ç”¨çš„ showConfirmModal å‡½æ•¸ï¼ˆè¤‡è£½è‡ª eform05.phpï¼‰
            showConfirmModal() {
                // é©—è­‰å¿…å¡«æ¬„ä½
                var name = $('input[name="name"]').val();
                var phone = $('input[name="phone"]').val();
                var gender = $('select[name="gender"]').val();
                var age = $('select[name="age"]').val();

                if (!name || !phone || !gender || !age) {
                    alert('è«‹å¡«å¯«å§“åã€æ‰‹æ©Ÿè™Ÿç¢¼ã€æ€§åˆ¥ã€å¹´é½¡ç­‰å¿…å¡«æ¬„ä½');
                    return;
                }

                // æ”¶é›†å®Œæ•´è¡¨å–®è³‡æ–™é€²è¡Œé¡¯ç¤º
                var formSummary = this.collectFormDataForDisplay();
                
                // å°‡è³‡æ–™è¼‰å…¥åˆ° modal ä¸­
                $('#confirmModalBody').html(formSummary);
                
                // é¡¯ç¤º Bootstrap modal
                $('#confirmModal').modal('show');
                
                // ç¶å®šç¢ºèªé€å‡ºæŒ‰éˆ•äº‹ä»¶
                $('#confirmSubmitBtn').off('click').on('click', function() {
                    $('#confirmModal').modal('hide');
                    alert('æ¸¬è©¦ï¼šè¡¨å–®é€å‡ºæˆåŠŸï¼');
                });
            }
            
            // æ”¶é›†è¡¨å–®è³‡æ–™é¡¯ç¤ºå‡½æ•¸ï¼ˆè¤‡è£½è‡ª eform05.phpï¼‰
            collectFormDataForDisplay() {
                var html = '<div class="form-confirmation-content">';
                
                // 1. åŸºæœ¬è³‡æ–™å€å¡Š
                html += '<div class="info-block mb-3" style="background-color: #f8f9fa; padding: 15px; border-radius: 5px;">';
                html += '<h6 class="mb-3"><strong>åŸºæœ¬è³‡æ–™</strong></h6>';
                html += '<div class="row">';
                html += '<div class="col-4"><strong>å§“åï¼š</strong>' + ($('input[name="name"]').val() || 'æœªå¡«å¯«') + '</div>';
                html += '<div class="col-4"><strong>æœƒå“¡ç·¨è™Ÿï¼š</strong>000000</div>';
                html += '<div class="col-4"><strong>æ€§åˆ¥ï¼š</strong>' + ($('select[name="gender"]').val() || 'æœªé¸æ“‡') + '</div>';
                html += '</div>';
                html += '<div class="row mt-2">';
                html += '<div class="col-4"><strong>å¹´é½¡ï¼š</strong>' + ($('select[name="age"]').val() ? $('select[name="age"]').val() + 'æ­²' : 'æœªé¸æ“‡') + '</div>';
                html += '<div class="col-4"><strong>æ‰‹æ©Ÿï¼š</strong>' + ($('input[name="phone"]').val() || 'æœªå¡«å¯«') + '</div>';
                html += '<div class="col-4"><strong>é‹å‹•ç¿’æ…£ï¼š</strong>' + ($('select[name="exercise_habit"]').val() || 'æœªé¸æ“‡') + '</div>';
                html += '</div>';
                html += '</div>';

                // 2. é«”æ¸¬æ•¸æ“šå€å¡Š
                html += '<div class="info-block mb-3" style="background-color: #f8f9fa; padding: 15px; border-radius: 5px;">';
                html += '<h6 class="mb-3"><strong>é«”æ¸¬æ¨™æº–å»ºè­°å€¼</strong></h6>';
                html += '<div class="row">';
                html += '<div class="col-4"><strong>é«”é‡ï¼š</strong>' + ($('input[name="weight"]').val() ? $('input[name="weight"]').val() + 'kg' : 'æœªå¡«å¯«') + '</div>';
                html += '<div class="col-4"><strong>BMIï¼š</strong>' + ($('input[name="bmi"]').val() || 'æœªå¡«å¯«') + '</div>';
                html += '<div class="col-4"><strong>é«”è„‚ç‡ï¼š</strong>' + ($('input[name="fat_percentage"]').val() ? $('input[name="fat_percentage"]').val() + '%' : 'æœªå¡«å¯«') + '</div>';
                html += '</div>';
                html += '</div>';

                // 3. è·æ¥­èˆ‡å¥åº·ç‹€æ³å€å¡Š
                var occupations = [];
                $('input[name="occupation[]"]:checked').each(function() {
                    occupations.push($(this).next().text() || $(this).val());
                });
                var healthConcerns = [];
                $('input[name="health_concerns[]"]:checked').each(function() {
                    healthConcerns.push($(this).next().text() || $(this).val());
                });
                
                html += '<div class="info-block mb-3" style="background-color: #f8f9fa; padding: 15px; border-radius: 5px;">';
                html += '<h6 class="mb-3"><strong>è·æ¥­èˆ‡å¥åº·ç‹€æ³</strong></h6>';
                html += '<div class="row">';
                html += '<div class="col-6"><strong>è·æ¥­ï¼š</strong>' + (occupations.length > 0 ? occupations.join('ã€') : 'æœªé¸æ“‡') + '</div>';
                html += '<div class="col-6"><strong>å¥åº·å›°æ“¾ï¼š</strong>' + (healthConcerns.length > 0 ? healthConcerns.join('ã€') : 'ç„¡') + '</div>';
                html += '</div>';
                html += '</div>';

                // 4. ç”¨è—¥è³‡è¨Šå€å¡Š
                var hasMedication = $('input[name="has_medication_habit"]:checked').val();
                html += '<div class="info-block mb-3" style="background-color: #f8f9fa; padding: 15px; border-radius: 5px;">';
                html += '<h6 class="mb-3"><strong>ç”¨è—¥è³‡è¨Š</strong></h6>';
                html += '<div class="row">';
                html += '<div class="col-6"><strong>ç”¨è—¥ç¿’æ…£ï¼š</strong>' + (hasMedication === '1' ? 'æ˜¯' : 'å¦') + '</div>';
                if (hasMedication === '1') {
                    html += '<div class="col-6"><strong>è—¥ç‰©åç¨±ï¼š</strong>' + ($('input[name="medication_name"]').val() || 'æœªå¡«å¯«') + '</div>';
                }
                html += '</div>';
                html += '</div>';

                // 5. å»ºè­°ç”¢å“å€å¡Š
                var recommendedProducts = [];
                $('input[name="recommended_products[]"]:checked').each(function() {
                    recommendedProducts.push($(this).next().text() || $(this).val());
                });
                
                html += '<div class="info-block mb-3" style="background-color: #f8f9fa; padding: 15px; border-radius: 5px;">';
                html += '<h6 class="mb-3"><strong>å»ºè­°ç”¢å“</strong></h6>';
                html += '<div class="row">';
                html += '<div class="col-12"><strong>æ¨è–¦ç”¢å“ï¼š</strong>' + (recommendedProducts.length > 0 ? recommendedProducts.join('ã€') : 'ç„¡') + '</div>';
                html += '</div>';
                
                // ç”¢å“æ”å–é‡
                var dosageFields = [
                    {field: 'energy_essence_dosage', label: 'ç²¾åŠ›ç´ '},
                    {field: 'reishi_ex_dosage', label: 'éˆèŠEX'}, 
                    {field: 'vitamin_c_dosage', label: 'ç¶­ä»–å‘½C'},
                    {field: 'energy_crystal_dosage', label: 'ç²¾åŠ›çµæ™¶'},
                    {field: 'reishi_tea_dosage', label: 'éˆèŠèŒ¶'}
                ];
                
                var dosageCount = 0;
                var dosageHtml = '';
                dosageFields.forEach(function(dosage) {
                    var value = $('input[name="' + dosage.field + '"]').val();
                    if (value) {
                        if (dosageCount % 3 === 0) {
                            if (dosageCount > 0) dosageHtml += '</div>';
                            dosageHtml += '<div class="row mt-2">';
                        }
                        dosageHtml += '<div class="col-4"><strong>' + dosage.label + 'ï¼š</strong>' + value + '</div>';
                        dosageCount++;
                    }
                });
                if (dosageCount > 0) {
                    dosageHtml += '</div>';
                    html += dosageHtml;
                }
                
                html += '</div>';
                html += '</div>';
                
                return html;
            }
            
            // æ¸¬è©¦ 1: Bootstrap è¼‰å…¥æª¢æŸ¥
            testBootstrapLoaded() {
                try {
                    if (typeof $.fn.modal !== 'undefined') {
                        return { pass: true, message: 'Bootstrap modal å‡½æ•¸å·²æ­£ç¢ºè¼‰å…¥' };
                    } else {
                        return { pass: false, message: 'Bootstrap modal å‡½æ•¸æœªè¼‰å…¥' };
                    }
                } catch (e) {
                    return { pass: false, message: 'æ¸¬è©¦ Bootstrap è¼‰å…¥æ™‚ç™¼ç”ŸéŒ¯èª¤: ' + e.message };
                }
            }
            
            // æ¸¬è©¦ 2: Modal é¡¯ç¤ºåŠŸèƒ½
            testModalShow() {
                try {
                    // å˜—è©¦é¡¯ç¤º modal
                    $('#confirmModal').modal('show');
                    
                    // æª¢æŸ¥ modal æ˜¯å¦é¡¯ç¤º
                    setTimeout(() => {
                        if ($('#confirmModal').hasClass('show')) {
                            this.addResult({ pass: true, message: 'Modal é¡¯ç¤ºåŠŸèƒ½æ­£å¸¸' });
                            $('#confirmModal').modal('hide'); // éš±è— modal
                        } else {
                            this.addResult({ pass: false, message: 'Modal ç„¡æ³•æ­£å¸¸é¡¯ç¤º' });
                        }
                    }, 500);
                    
                    return { pass: true, message: 'Modal é¡¯ç¤ºæ¸¬è©¦åŸ·è¡Œä¸­...' };
                } catch (e) {
                    return { pass: false, message: 'æ¸¬è©¦ Modal é¡¯ç¤ºæ™‚ç™¼ç”ŸéŒ¯èª¤: ' + e.message };
                }
            }
            
            // æ¸¬è©¦ 3: è¡¨å–®è³‡æ–™æ”¶é›†
            testFormDataCollection() {
                try {
                    var formData = this.collectFormDataForDisplay();
                    
                    if (formData && formData.length > 0) {
                        // æª¢æŸ¥æ˜¯å¦åŒ…å«åŸºæœ¬è³‡æ–™
                        if (formData.includes('åŸºæœ¬è³‡æ–™') && formData.includes('æ¸¬è©¦ç”¨æˆ¶')) {
                            return { pass: true, message: 'è¡¨å–®è³‡æ–™æ”¶é›†åŠŸèƒ½æ­£å¸¸ï¼ŒåŒ…å«åŸºæœ¬è³‡æ–™' };
                        } else {
                            return { pass: false, message: 'è¡¨å–®è³‡æ–™æ”¶é›†ä¸å®Œæ•´ï¼Œç¼ºå°‘åŸºæœ¬è³‡æ–™' };
                        }
                    } else {
                        return { pass: false, message: 'è¡¨å–®è³‡æ–™æ”¶é›†å¤±æ•—ï¼Œè¿”å›ç©ºè³‡æ–™' };
                    }
                } catch (e) {
                    return { pass: false, message: 'æ¸¬è©¦è¡¨å–®è³‡æ–™æ”¶é›†æ™‚ç™¼ç”ŸéŒ¯èª¤: ' + e.message };
                }
            }
            
            // æ¸¬è©¦ 4: Modal å…§å®¹æ­£ç¢ºæ€§
            testModalContent() {
                try {
                    // å¡«å…¥æ¸¬è©¦è³‡æ–™åˆ° modal
                    var formSummary = this.collectFormDataForDisplay();
                    $('#confirmModalBody').html(formSummary);
                    
                    // æª¢æŸ¥ modal å…§å®¹
                    var modalContent = $('#confirmModalBody').html();
                    
                    var checks = [
                        { condition: modalContent.includes('æ¸¬è©¦ç”¨æˆ¶'), name: 'å§“å' },
                        { condition: modalContent.includes('0912345678'), name: 'æ‰‹æ©Ÿ' },
                        { condition: modalContent.includes('ç”·'), name: 'æ€§åˆ¥' },
                        { condition: modalContent.includes('ä¸Šç­æ—'), name: 'è·æ¥­' },
                        { condition: modalContent.includes('å¤±çœ '), name: 'å¥åº·å›°æ“¾' }
                    ];
                    
                    var passedChecks = checks.filter(check => check.condition);
                    var failedChecks = checks.filter(check => !check.condition);
                    
                    if (failedChecks.length === 0) {
                        return { pass: true, message: `Modal å…§å®¹æ­£ç¢ºæ€§é©—è­‰é€šé (${passedChecks.length}/${checks.length})` };
                    } else {
                        var failedNames = failedChecks.map(check => check.name).join(', ');
                        return { pass: false, message: `Modal å…§å®¹é©—è­‰å¤±æ•—ï¼Œç¼ºå°‘ï¼š${failedNames}` };
                    }
                } catch (e) {
                    return { pass: false, message: 'æ¸¬è©¦ Modal å…§å®¹æ™‚ç™¼ç”ŸéŒ¯èª¤: ' + e.message };
                }
            }
            
            // æ¸¬è©¦ 5: å¿…å¡«æ¬„ä½é©—è­‰
            testRequiredFieldValidation() {
                try {
                    // æ¸…ç©ºå¿…å¡«æ¬„ä½
                    $('input[name="name"]').val('');
                    
                    // å˜—è©¦è§¸ç™¼é©—è­‰
                    var originalAlert = window.alert;
                    var alertCalled = false;
                    window.alert = function(message) {
                        alertCalled = true;
                        return message;
                    };
                    
                    this.showConfirmModal();
                    
                    // æ¢å¾©åŸå§‹ alert
                    window.alert = originalAlert;
                    
                    // æ¢å¾©æ¸¬è©¦è³‡æ–™
                    $('input[name="name"]').val('æ¸¬è©¦ç”¨æˆ¶');
                    
                    if (alertCalled) {
                        return { pass: true, message: 'å¿…å¡«æ¬„ä½é©—è­‰åŠŸèƒ½æ­£å¸¸' };
                    } else {
                        return { pass: false, message: 'å¿…å¡«æ¬„ä½é©—è­‰æœªè§¸ç™¼' };
                    }
                } catch (e) {
                    return { pass: false, message: 'æ¸¬è©¦å¿…å¡«æ¬„ä½é©—è­‰æ™‚ç™¼ç”ŸéŒ¯èª¤: ' + e.message };
                }
            }
            
            // æ¸¬è©¦ 6: Modal äº‹ä»¶ç¶å®š
            testModalEventBinding() {
                try {
                    // è§¸ç™¼ showConfirmModal
                    this.showConfirmModal();
                    
                    // æª¢æŸ¥ç¢ºèªæŒ‰éˆ•æ˜¯å¦æœ‰äº‹ä»¶ç¶å®š
                    var events = $._data($('#confirmSubmitBtn')[0], "events");
                    
                    if (events && events.click) {
                        $('#confirmModal').modal('hide'); // éš±è— modal
                        return { pass: true, message: 'Modal äº‹ä»¶ç¶å®šæ­£å¸¸' };
                    } else {
                        return { pass: false, message: 'Modal äº‹ä»¶ç¶å®šå¤±æ•—' };
                    }
                } catch (e) {
                    return { pass: false, message: 'æ¸¬è©¦ Modal äº‹ä»¶ç¶å®šæ™‚ç™¼ç”ŸéŒ¯èª¤: ' + e.message };
                }
            }
            
            // æ·»åŠ æ¸¬è©¦çµæœ
            addResult(result) {
                this.results.push(result);
                this.displayResult(result);
            }
            
            // é¡¯ç¤ºæ¸¬è©¦çµæœ
            displayResult(result) {
                var resultDiv = $('<div class="test-result"></div>');
                resultDiv.addClass(result.pass ? 'test-pass' : 'test-fail');
                resultDiv.html(`
                    <strong>${result.pass ? 'âœ“ PASS' : 'âœ— FAIL'}</strong>: ${result.message}
                `);
                $('#test-results').append(resultDiv);
            }
            
            // åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦
            runAllTests() {
                this.clearResults();
                
                var tests = [
                    { name: 'Bootstrap è¼‰å…¥æª¢æŸ¥', fn: () => this.testBootstrapLoaded() },
                    { name: 'è¡¨å–®è³‡æ–™æ”¶é›†æ¸¬è©¦', fn: () => this.testFormDataCollection() },
                    { name: 'Modal å…§å®¹æ­£ç¢ºæ€§æ¸¬è©¦', fn: () => this.testModalContent() },
                    { name: 'å¿…å¡«æ¬„ä½é©—è­‰æ¸¬è©¦', fn: () => this.testRequiredFieldValidation() },
                    { name: 'Modal äº‹ä»¶ç¶å®šæ¸¬è©¦', fn: () => this.testModalEventBinding() },
                    { name: 'Modal é¡¯ç¤ºåŠŸèƒ½æ¸¬è©¦', fn: () => this.testModalShow() }
                ];
                
                var infoDiv = $('<div class="test-result test-info"></div>');
                infoDiv.html(`<strong>é–‹å§‹åŸ·è¡Œ ${tests.length} é … TDD æ¸¬è©¦...</strong>`);
                $('#test-results').append(infoDiv);
                
                tests.forEach((test, index) => {
                    setTimeout(() => {
                        var result = test.fn();
                        if (result) {
                            this.addResult(result);
                        }
                        
                        // æœ€å¾Œä¸€å€‹æ¸¬è©¦å®Œæˆæ™‚é¡¯ç¤ºç¸½çµ
                        if (index === tests.length - 1) {
                            setTimeout(() => this.showSummary(), 1000);
                        }
                    }, index * 200);
                });
            }
            
            // é¡¯ç¤ºæ¸¬è©¦ç¸½çµ
            showSummary() {
                var passed = this.results.filter(r => r.pass).length;
                var total = this.results.length;
                var summaryDiv = $('<div class="test-result"></div>');
                
                if (passed === total) {
                    summaryDiv.addClass('test-pass');
                    summaryDiv.html(`<strong>ğŸ‰ æ‰€æœ‰æ¸¬è©¦é€šéï¼</strong> (${passed}/${total})`);
                } else {
                    summaryDiv.addClass('test-fail');
                    summaryDiv.html(`<strong>âš ï¸ æ¸¬è©¦å®Œæˆ</strong> - é€šé: ${passed}/${total}, å¤±æ•—: ${total - passed}`);
                }
                
                $('#test-results').append(summaryDiv);
            }
            
            // æ¸…é™¤æ¸¬è©¦çµæœ
            clearResults() {
                this.results = [];
                $('#test-results').empty();
            }
        }
        
        // å»ºç«‹æ¸¬è©¦å¯¦ä¾‹
        const modalTest = new ModalTDDTest();
        
        // å…¨åŸŸå‡½æ•¸
        function showConfirmModal() {
            modalTest.showConfirmModal();
        }
        
        function runAllTests() {
            modalTest.runAllTests();
        }
        
        function runSingleTest() {
            modalTest.clearResults();
            var result = modalTest.testBootstrapLoaded();
            modalTest.addResult(result);
        }
        
        function clearTestResults() {
            modalTest.clearResults();
        }
        
        // é é¢è¼‰å…¥å®Œæˆå¾Œè‡ªå‹•åŸ·è¡ŒåŸºæœ¬æª¢æŸ¥
        $(document).ready(function() {
            var infoDiv = $('<div class="test-result test-info"></div>');
            infoDiv.html('<strong>é é¢è¼‰å…¥å®Œæˆ</strong> - é»æ“Šã€ŒåŸ·è¡Œæ‰€æœ‰æ¸¬è©¦ã€é–‹å§‹ TDD é©—è­‰');
            $('#test-results').append(infoDiv);
        });
    </script>
</body>
</html>